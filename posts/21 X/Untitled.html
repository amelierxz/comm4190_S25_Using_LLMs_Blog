<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Amelie Zhang">
<meta name="dcterms.date" content="2024-05-03">
<meta name="description" content="Realistically this is not a good idea, but I wanted to give it a try.">

<title>An AI stock picker: Can a LLM help me make good investments? ‚Äì My Explorations with LLMs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-d73a3becde7ab5743b8a88b26cbb919d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">My Explorations with LLMs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About the writer - Amelie!</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">An AI stock picker: Can a LLM help me make good investments?</h1>
                  <div>
        <div class="description">
          Realistically this is not a good idea, but I wanted to give it a try.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">language</div>
                <div class="quarto-category">learning!</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Amelie Zhang </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 3, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="prompt" class="level1">
<h1>Prompt:</h1>
<p>You are my stock picker. Read about the tariffs and pick 10 stocks I should look deeper into.</p>
</section>
<section id="answer" class="level1">
<h1>Answer:</h1>
<p>Based on the current tariff landscape and recent market movements, here are 10 stocks you might consider researching further. These selections are influenced by how tariffs are impacting various sectors, either positively or negatively.</p>
<hr>
<section id="potential-beneficiaries-of-tariff-changes" class="level3">
<h3 class="anchored" data-anchor-id="potential-beneficiaries-of-tariff-changes">üìà Potential Beneficiaries of Tariff Changes</h3>
<ol type="1">
<li><p><strong>Carvana Co.&nbsp;(CVNA)</strong></p>
<ul>
<li>As tariffs on new vehicles push prices higher, the used-car market is experiencing increased demand. Carvana has reported a surge in sales and exceeded Q1 expectations, positioning itself well in the current environment. (<a href="https://www.investors.com/news/carvana-stock-used-cars-tariffs/?utm_source=chatgpt.com" title="Used-Car Prices Jump On Tariffs, Lifting Carvana, These Other Auto-Retail Stocks">Investors</a>)</li>
</ul></li>
<li><p><strong>Nucor Corporation (NUE)</strong></p>
<ul>
<li>Being a major U.S. steel producer, Nucor stands to benefit from tariffs on imported steel, which make domestic steel more competitive. The company‚Äôs stock has shown resilience amid trade tensions.</li>
</ul></li>
<li><p><strong>Caterpillar Inc.&nbsp;(CAT)</strong></p>
<ul>
<li>Despite facing increased costs due to tariffs, Caterpillar‚Äôs strong domestic manufacturing base and demand for heavy machinery could offset some negative impacts. The company continues to be a significant player in the industrial sector. </li>
</ul></li>
<li><p><strong>Dollar Tree, Inc.&nbsp;(DLTR)</strong></p>
<ul>
<li>As consumers look for cost-effective shopping options amid rising prices, discount retailers like Dollar Tree may see increased foot traffic and sales. </li>
</ul></li>
<li><p><strong>MercadoLibre, Inc.&nbsp;(MELI)</strong></p>
<ul>
<li>Operating primarily in Latin America, MercadoLibre is less exposed to U.S.-China trade tensions. The company could benefit from shifting trade dynamics and increased e-commerce adoption in its markets. </li>
</ul></li>
</ol>
<hr>
</section>
<section id="companies-facing-tariff-related-challenges" class="level3">
<h3 class="anchored" data-anchor-id="companies-facing-tariff-related-challenges">‚ö†Ô∏è Companies Facing Tariff-Related Challenges</h3>
<ol start="6" type="1">
<li><p><strong>Tesla, Inc.&nbsp;(TSLA)</strong></p>
<ul>
<li>Tesla is grappling with declining deliveries and increased competition, particularly from BYD, which has surpassed Tesla in global EV sales. Tariffs are adding to the company‚Äôs challenges by increasing production costs. (<a href="https://www.investors.com/news/tesla-vs-byd-ev-sales-robotaxis/?utm_source=chatgpt.com" title="Tesla Vs. BYD: TSLA Flashes Aggressive Entry While Rival Nears Buy Point">Investors</a>)</li>
</ul></li>
<li><p><strong>Apple Inc.&nbsp;(AAPL)</strong></p>
<ul>
<li>Apple is accelerating its production shift away from China due to tariff pressures. While this strategy aims to mitigate long-term risks, the transition period may introduce supply chain complexities. (<a href="https://www.investors.com/news/trump-tariffs-apple-amazon-gm-saying/?utm_source=chatgpt.com" title="What Apple, Amazon, GM And Other Companies Are Saying About Trump Tariffs">Investors</a>)</li>
</ul></li>
<li><p><strong>Ford Motor Company (F)</strong></p>
<ul>
<li>Ford anticipates a $1.5 billion impact from tariffs in 2025 and has suspended its full-year earnings guidance. The company is navigating increased costs and supply chain disruptions. (<a href="https://www.investors.com/news/trump-tariffs-apple-amazon-gm-saying/?utm_source=chatgpt.com" title="What Apple, Amazon, GM And Other Companies Are Saying About Trump Tariffs">Investors</a>)</li>
</ul></li>
<li><p><strong>General Motors Company (GM)</strong></p>
<ul>
<li>GM expects up to $5 billion in tariff-related costs this year, leading to adjustments in its operations and financial forecasts. The company is actively seeking ways to mitigate these impacts. (<a href="https://www.investors.com/news/trump-tariffs-apple-amazon-gm-saying/?utm_source=chatgpt.com" title="What Apple, Amazon, GM And Other Companies Are Saying About Trump Tariffs">Investors</a>)</li>
</ul></li>
<li><p><strong>Pfizer Inc.&nbsp;(PFE)</strong></p>
<ul>
<li>With impending pharmaceutical tariffs and executive actions aimed at reducing drug prices, Pfizer faces potential revenue pressures and increased regulatory scrutiny. </li>
</ul></li>
</ol>
<hr>
<p>These selections are based on current market analyses and the evolving trade environment. It‚Äôs essential to conduct thorough research and consider your investment goals and risk tolerance before making any investment decisions.</p>
</section>
</section>
<section id="second-prompt" class="level1">
<h1>Second prompt:</h1>
<p>Give me proper financials and updates about each company.</p>
</section>
<section id="response" class="level1">
<h1>Response:</h1>
<p>Certainly! Here‚Äôs a detailed overview of the latest financial results and stock performance for the 10 companies previously discussed, reflecting their positions amid recent tariff developments:</p>
<hr>
<section id="potential-beneficiaries-of-tariff-changes-1" class="level3">
<h3 class="anchored" data-anchor-id="potential-beneficiaries-of-tariff-changes-1">üìà Potential Beneficiaries of Tariff Changes</h3>
<p><strong>1. Carvana Co.&nbsp;(CVNA)</strong></p>
<ul>
<li><p><strong>Q1 2025 Highlights</strong>:</p>
<ul>
<li>Retail units sold: 133,898 (+46% YoY)</li>
<li>Revenue: $4.232 billion (+38% YoY)</li>
<li>Net income: $373 million (8.8% margin)</li>
<li>Adjusted EBITDA: $488 million (11.5% margin)</li>
</ul></li>
<li><p><strong>Stock Performance</strong>: Currently trading at $273.58, up 2.04% today.</p></li>
</ul>
<p><strong>2. Nucor Corporation (NUE)</strong></p>
<ul>
<li><p><strong>Q1 2025 Highlights</strong>:</p>
<ul>
<li>Net earnings: $156 million ($0.67 per share)</li>
<li>Adjusted earnings: $179 million ($0.77 per share)</li>
<li>EBITDA: $696 million</li>
</ul></li>
<li><p><strong>Stock Performance</strong>: Currently trading at $120.11, up 4.85% today.</p></li>
</ul>
<p><strong>3. Caterpillar Inc.&nbsp;(CAT)</strong></p>
<ul>
<li><p><strong>Q1 2025 Highlights</strong>:</p>
<ul>
<li>Revenue: $14.2 billion (-10% YoY)</li>
<li>Adjusted operating profit: $2.6 billion (18.3% margin)</li>
<li>Adjusted EPS: $4.25</li>
</ul></li>
<li><p><strong>Stock Performance</strong>: Currently trading at $340.66, up 4.83% today.</p></li>
</ul>
<p><strong>4. Dollar Tree, Inc.&nbsp;(DLTR)</strong></p>
<ul>
<li><p><strong>FY 2024 Highlights</strong>:</p>
<ul>
<li>Revenue: $17.6 billion (+4.8% YoY)</li>
<li>Net income: $1.04 billion (-18% YoY)</li>
<li>Profit margin: 5.9% (down from 7.5%)</li>
</ul></li>
<li><p><strong>Stock Performance</strong>: Currently trading at $89.21, up 4.38% today.</p></li>
</ul>
<p><strong>5. MercadoLibre, Inc.&nbsp;(MELI)</strong></p>
<ul>
<li><p><strong>Q1 2025 Highlights</strong>:</p>
<ul>
<li>Revenue: $5.9 billion (+37% YoY)</li>
<li>Net income: $494 million</li>
<li>EPS: $9.74 (vs.&nbsp;$8.27 expected)</li>
</ul></li>
<li><p><strong>Stock Performance</strong>: Currently trading at $2,491.00, up 1.67% today.</p></li>
</ul>
<hr>
</section>
<section id="companies-facing-tariff-related-challenges-1" class="level3">
<h3 class="anchored" data-anchor-id="companies-facing-tariff-related-challenges-1">‚ö†Ô∏è Companies Facing Tariff-Related Challenges</h3>
<p><strong>6. Tesla, Inc.&nbsp;(TSLA)</strong></p>
<ul>
<li><p><strong>Q1 2025 Highlights</strong>:</p>
<ul>
<li>Deliveries: 336,681 vehicles (-13% YoY)</li>
<li>Revenue: $21.3 billion</li>
<li>Net income: $1.13 billion (-40% YoY)</li>
<li>Operating margin: 2%</li>
</ul></li>
<li><p><strong>Stock Performance</strong>: Currently trading at $319.12, up 7.18% today.</p></li>
</ul>
<p><strong>7. Apple Inc.&nbsp;(AAPL)</strong></p>
<ul>
<li><p><strong>Q1 2025 Highlights</strong>:</p>
<ul>
<li>Revenue: $124.3 billion (+4% YoY)</li>
<li>Net income: $36.3 billion (+7.1% YoY)</li>
<li>EPS: $2.40 (vs.&nbsp;$2.35 expected)</li>
</ul></li>
<li><p><strong>Stock Performance</strong>: Currently trading at $208.87, up 5.21% today.</p></li>
</ul>
<p><strong>8. Ford Motor Company (F)</strong></p>
<ul>
<li><p><strong>Q1 2025 Highlights</strong>:</p>
<ul>
<li>Revenue: $40.7 billion (-5% YoY)</li>
<li>Net income: $471 million (-64% YoY)</li>
<li>Adjusted EBIT: $1 billion</li>
<li>Tariff impact: Estimated $1.5 billion hit to pretax earnings</li>
</ul></li>
<li><p><strong>Stock Performance</strong>: Currently trading at $10.53, up 0.81% today.</p></li>
</ul>
<p><strong>9. General Motors Company (GM)</strong></p>
<ul>
<li><p><strong>Q1 2025 Highlights</strong>:</p>
<ul>
<li>Revenue: $44.0 billion (+2.3% YoY)</li>
<li>Net income: $2.8 billion (-6.6% YoY)</li>
<li>Adjusted EBIT: $3.5 billion</li>
<li>EPS: $2.78 (vs.&nbsp;$2.61 expected)</li>
</ul></li>
<li><p><strong>Stock Performance</strong>: Currently trading at $49.25, up 3.68% today.</p></li>
</ul>
<p><strong>10. Pfizer Inc.&nbsp;(PFE)</strong></p>
<ul>
<li><p><strong>Q1 2025 Highlights</strong>:</p>
<ul>
<li>Revenue: $13.7 billion (-8% YoY)</li>
<li>Net income: $2.97 billion (-5% YoY)</li>
<li>Adjusted EPS: $0.92 (vs.&nbsp;$0.64 expected)</li>
<li>Tariff impact: Potential future pharmaceutical tariffs could affect revenue</li>
</ul></li>
<li><p><strong>Stock Performance</strong>: Currently trading at $22.99, up 3.16% today.</p></li>
</ul>
<hr>
</section>
<section id="stock-market-information-for-carvana-co.-cvna" class="level2">
<h2 class="anchored" data-anchor-id="stock-market-information-for-carvana-co.-cvna">Stock market information for Carvana Co.&nbsp;(CVNA)</h2>
<ul>
<li>Carvana Co.&nbsp;is a equity in the USA market.</li>
<li>The price is 273.58 USD currently with a change of 5.46 USD (0.02%) from the previous close.</li>
<li>The latest open price was 274.26 USD and the intraday volume is 1882051.</li>
<li>The intraday high is 284.17 USD and the intraday low is 267.18 USD.</li>
<li>The latest trade time is Monday, May 12, 09:29:01 MST.</li>
</ul>
<p>Please let me know if you‚Äôd like further analysis on any of these companies or assistance in comparing specific metrics.</p>
</section>
</section>
<section id="third-prompt" class="level1">
<h1>Third prompt:</h1>
<p>Predict the increase/decrease of a portfolio equally weighted in these 5 beneficiaries in 1 year.</p>
<p><img src="a.png" width="50%"> <img src="b.png" width="50%"></p>
</section>
<section id="reflection" class="level1">
<h1>Reflection:</h1>
<p>Though I know that these predictions and judgements have purely no value in terms of actual insights unless simulated over time, I wanted to see how the LLM would justify these choices. I think that while the logic is there, the LLM may not be thinking deep enough compared to a human working at a hedge fund, for example.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/amelierxz\.github\.io\/comm4190_S25_Using_LLMs_Blog\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>